# Rust Tactical Map - Component Interactions & Data Flow

## ğŸ”— **COMPLEX SYSTEM INTERACTIONS**

### **Central Hub: TacticalMapPage**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      TACTICAL MAP PAGE                         â”‚
â”‚                   (Central Orchestrator)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚             â”‚             â”‚
   ğŸ›ï¸ STATE        ğŸ“¡ HOOKS      ğŸ”„ EFFECTS
   MANAGEMENT      & QUERIES    & HANDLERS
```

---

## ğŸŒ **DATA FLOW NETWORK**

### **1. State Management Web**
```
TacticalMapPage (Central State Hub)
â”œâ”€â”€ ğŸ—ºï¸ Map Interaction State
â”‚   â”œâ”€â”€ zoom (1-8x) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º TacticalMapGrid
â”‚   â”œâ”€â”€ pan {x, y} â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º TacticalMapBackground
â”‚   â”œâ”€â”€ isDragging â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Mouse Event Handlers
â”‚   â””â”€â”€ mapRef â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Wheel/Click Detection
â”‚
â”œâ”€â”€ ğŸ¢ Location Management
â”‚   â”œâ”€â”€ locations[] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º TacticalMapLocation (rendering)
â”‚   â”œâ”€â”€ selectedLocation â”€â”€â”€â”€â”€â–º BaseModal (editing)
â”‚   â”œâ”€â”€ editingLocation â”€â”€â”€â”€â”€â”€â–º BaseModal (update mode)
â”‚   â””â”€â”€ locationTimers{} â”€â”€â”€â”€â”€â–º WipeCountdownTimer
â”‚
â”œâ”€â”€ ğŸ“Š Modal Visibility Control
â”‚   â”œâ”€â”€ newBaseModal â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º BaseModal
â”‚   â”œâ”€â”€ showPlayerModal â”€â”€â”€â”€â”€â”€â–º PlayerModal
â”‚   â”œâ”€â”€ showLogsModal â”€â”€â”€â”€â”€â”€â”€â”€â–º LogsModal
â”‚   â”œâ”€â”€ showTeamsModal â”€â”€â”€â”€â”€â”€â”€â–º TeamsModal
â”‚   â”œâ”€â”€ showProgressionModal â”€â–º ProgressionModal
â”‚   â””â”€â”€ showBaseReportModal â”€â”€â–º ActionReportModal
â”‚
â”œâ”€â”€ ğŸ‘¥ Player & Report Data
â”‚   â”œâ”€â”€ players[] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º PlayerSearchSelector
â”‚   â”œâ”€â”€ premiumPlayers[] â”€â”€â”€â”€â”€â–º PlayerModal
â”‚   â””â”€â”€ baseReportData{} â”€â”€â”€â”€â”€â–º ActionReportModal
â”‚
â””â”€â”€ ğŸ¯ UI State Management
    â”œâ”€â”€ contextMenu â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º RadialMenu/BaseRadialMenu
    â”œâ”€â”€ modalType â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º BaseModal (friendly/enemy)
    â”œâ”€â”€ heatMapConfig â”€â”€â”€â”€â”€â”€â”€â–º HeatMapOverlay
    â””â”€â”€ progressionDisplay â”€â”€â–º ProgressionModal
```

### **2. Component Communication Matrix**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  COMPONENT      â”‚  RECEIVES FROM  â”‚   SENDS TO      â”‚  SHARED STATE   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TacticalMapPage â”‚ User Events     â”‚ All Components  â”‚ Central Hub     â”‚
â”‚ BaseModal       â”‚ TacticalMapPage â”‚ Database API    â”‚ formData{}      â”‚
â”‚ PlayerModal     â”‚ TacticalMapPage â”‚ Database API    â”‚ players[]       â”‚
â”‚ ReportPreview   â”‚ BaseModal       â”‚ ActionReport    â”‚ reports[]       â”‚
â”‚ PlayerSearch    â”‚ BaseModal       â”‚ BaseModal       â”‚ selectedPlayers â”‚
â”‚ HeatMapOverlay  â”‚ TacticalMapPage â”‚ Visual Layer    â”‚ heatMapConfig   â”‚
â”‚ RocketCalc      â”‚ BaseModal       â”‚ Gene Calculator â”‚ calculatorData  â”‚
â”‚ ActionReport    â”‚ Multiple        â”‚ Database API    â”‚ reportData{}    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ **DETAILED INTERACTION FLOWS**

### **Base Creation & Management Flow**
```
User Right-Click on Map
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    contextMenu.visible = true
â”‚ Context Menu    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
â”‚ (RadialMenu)    â”‚                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
         â”‚                                         â–¼
         â”‚ User selects "Add Base"          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â–¼                                  â”‚ TacticalMapPage â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚ State Update    â”‚
â”‚ setModalType()  â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ setNewBaseModal â”‚                                â”‚
â”‚ ({visible:true})â”‚                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â–¼
         â”‚                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â–¼                               â”‚ BaseModal       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Props Flow        â”‚ Opens with:     â”‚
â”‚ BaseModal       â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ - modalType     â”‚
â”‚ Component       â”‚                      â”‚ - modal coords  â”‚
â”‚ Renders         â”‚                      â”‚ - editingLoc    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                         â”‚
         â”‚ User fills form & saves                 â”‚
         â–¼                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ handleSaveBase  â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ onSave callback â”‚
â”‚ Function        â”‚                      â”‚ triggered       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Updates locations[]
â”‚ setLocations    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
â”‚ State Update    â”‚                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â–¼
         â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â–¼                        â”‚ TacticalMapLoc  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚ Re-renders with â”‚
â”‚ Modal Closes    â”‚              â”‚ new base marker â”‚
â”‚ newBaseModal    â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ {visible:false} â”‚                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚ Visual Update   â”‚
                                 â”‚ Map shows new   â”‚
                                 â”‚ base marker     â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Player Tagging Cross-Component Flow**
```
BaseModal (Base Owners)           PlayerModal (Player Activity)
        â”‚                                    â”‚
        â–¼                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚PlayerSearchSel  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Player Data     â”‚
â”‚ Component       â”‚   Shared API   â”‚ Display         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                    â”‚
        â”‚ Comma-separated                    â”‚
        â”‚ string format                      â”‚
        â–¼                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ "player1,       â”‚                â”‚ players[]       â”‚
â”‚  player2,       â”‚                â”‚ from API        â”‚
â”‚  player3"       â”‚                â”‚ /api/players    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                    â”‚
        â”‚ Parse & Display                    â”‚
        â–¼                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Array of player â”‚                â”‚ Heat Map Data   â”‚
â”‚ tags with       â”‚                â”‚ Activity        â”‚
â”‚ status indicatorsâ”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ Visualization   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ User adds/removes
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    onPlayersChange()
â”‚ Rejoin as       â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
â”‚ comma string    â”‚                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â–¼
        â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Update callback        â”‚ BaseModal       â”‚
        â–¼                        â”‚ formData.playersâ”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚ state update    â”‚
â”‚ Database Save   â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ via API call    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Report System Interconnections**
```
ActionReportModal                  BaseModal               LogsModal
        â”‚                             â”‚                       â”‚
        â”‚ Creates Report               â”‚ Shows Related         â”‚ Lists All
        â–¼                             â”‚ Reports               â–¼ Reports
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â–¼                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Report Data     â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚ Report List     â”‚
â”‚ {type, notes,   â”‚ â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ ReportPreview   â”‚â—„â”€â”€â”€â”€â”€â”€â”‚ with Filters    â”‚
â”‚  players, etc}  â”‚         â”‚ Component       â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
        â”‚                             â”‚                       â”‚
        â”‚ POST /api/reports            â”‚ Shared Display        â”‚
        â–¼                             â”‚ Logic                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â–¼                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Database        â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚ Query Filters   â”‚
â”‚ Storage         â”‚         â”‚ Unified Report  â”‚       â”‚ by Type/Player  â”‚
â”‚ Dual ID System  â”‚         â”‚ Formatting      â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
        â”‚                             â”‚                       â”‚
        â”‚ Returns saved report        â”‚                       â”‚
        â–¼                             â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Map Marker      â”‚         â”‚ Status Icons    â”‚       â”‚ PlayerModal     â”‚
â”‚ Creation        â”‚ â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Enemy/Friendly  â”‚â—„â”€â”€â”€â”€â”€â”€â”‚ Report Filter   â”‚
â”‚ Visual Update   â”‚         â”‚ Player Tags     â”‚       â”‚ Integration     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§¬ **GENETICS INTEGRATION NETWORK**

### **Gene Calculator Cross-Window Communication**
```
Main Window (TacticalMapPage)          Popup Window (gene-calculator.html)
        â”‚                                           â”‚
        â”‚ openGeneCalculator()                      â”‚
        â–¼                                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ window.open()   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ Independent     â”‚
â”‚ Creates popup   â”‚                        â”‚ HTML/JS App     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                           â”‚
        â”‚ Listen for messages                       â”‚ Gene calculations
        â–¼                                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ window.addEvent â”‚                        â”‚ Advanced Gene   â”‚
â”‚ Listener        â”‚                        â”‚ Algorithms      â”‚
â”‚ 'message'       â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ Quality Calc    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    postMessage API     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                           â”‚
        â”‚ Receives gene data                        â”‚
        â–¼                                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚ ProgressionModalâ”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ Updates display â”‚   Real-time sync
â”‚ with gene info  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ Same data format as calculator
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Gene Quality    â”‚
â”‚ Color Coding    â”‚
â”‚ Progress %      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ **HEAT MAP INTEGRATION WEB**

### **Multi-Source Data Aggregation**
```
Player Activity Data               Base Location Data              Session History
        â”‚                                 â”‚                               â”‚
        â”‚ API: /api/players                â”‚ locations[] state             â”‚ Database queries
        â–¼                                 â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Real-time       â”‚            â”‚ Base positions  â”‚             â”‚ Historical      â”‚
â”‚ Player Status   â”‚            â”‚ & types         â”‚             â”‚ Player Sessions â”‚
â”‚ Online/Offline  â”‚            â”‚ Enemy/Friendly  â”‚             â”‚ Time tracking   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                 â”‚                               â”‚
        â”‚                                 â”‚                               â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚               â”‚
                          â–¼               â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚   HeatMapCalculator.ts      â”‚
                   â”‚   Advanced Algorithms       â”‚
                   â”‚   - Proximity weighting     â”‚
                   â”‚   - Time-based decay        â”‚
                   â”‚   - Activity clustering     â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚     HeatMapOverlay.tsx      â”‚
                   â”‚     Visual Rendering        â”‚
                   â”‚   - Gradient calculations   â”‚
                   â”‚   - Color interpolation     â”‚
                   â”‚   - SVG path generation     â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚      Map Layer Stack       â”‚â—„â”€â”€â”€â”‚ HeatMapControls â”‚
                   â”‚  Background â†’ Grid â†’       â”‚    â”‚ User Settings   â”‚
                   â”‚  HeatMap â†’ Locations       â”‚    â”‚ Intensity, etc  â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”Œ **API INTEGRATION MATRIX**

### **Database â†’ Component Data Flow**
```
PostgreSQL Database                 Express API Routes              React Components
        â”‚                                  â”‚                            â”‚
        â”‚ Drizzle ORM                      â”‚ Route Handlers             â”‚ React Query
        â–¼                                  â–¼                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ reports table   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ /api/reports    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ LogsModal       â”‚
â”‚ dual ID system  â”‚            â”‚ CRUD operations â”‚           â”‚ useQuery hook   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                  â”‚                            â”‚
        â”‚                                  â”‚                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ premium_players â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ /api/premium-   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ PlayerModal     â”‚
â”‚ table           â”‚            â”‚ players         â”‚           â”‚ Premium status  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                  â”‚                            â”‚
        â”‚                                  â”‚                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ player_base_tagsâ”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ /api/player-    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ BaseModal       â”‚
â”‚ associations    â”‚            â”‚ base-tags       â”‚           â”‚ PlayerSearch    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **External API Integration**
```
Battlemetrics API                SuperInfo API                 Gene Calculator
        â”‚                            â”‚                              â”‚
        â”‚ Player status              â”‚ Server data                  â”‚ Genetic algorithms
        â–¼                            â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Real-time       â”‚         â”‚ Server          â”‚          â”‚ Plant Breeding  â”‚
â”‚ Online/Offline  â”‚         â”‚ Population      â”‚          â”‚ Optimization    â”‚
â”‚ Player Data     â”‚         â”‚ Statistics      â”‚          â”‚ Calculations    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                            â”‚                              â”‚
        â”‚ HTTP requests              â”‚ Error handling               â”‚ Popup window
        â–¼                            â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ /api/players    â”‚         â”‚ Fallback data   â”‚          â”‚ ProgressionModalâ”‚
â”‚ endpoint        â”‚         â”‚ when API down   â”‚          â”‚ Data sync       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš¡ **EVENT PROPAGATION CHAINS**

### **Mouse Interaction Chain**
```
User Mouse Event
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Map Container   â”‚ â”€â”€â”€â”€ onWheel â”€â”€â”€â”€â–º Zoom Handler
â”‚ Event Capture   â”‚                   
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”€â”€â”€â”€ onMouseDown â”€â–º Drag Handler
        â”‚                             
        â”‚           â”€â”€â”€â”€ onClick â”€â”€â”€â”€â–º Location Selection
        â–¼                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”€â”€â”€â”€ onContext â”€â”€â–º Radial Menu
â”‚ Event Delegationâ”‚                   
â”‚ & Propagation   â”‚                   
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   
        â”‚                             
        â–¼                             
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   
â”‚ State Updates   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Re-render Cycle
â”‚ Trigger Cascade â”‚                   
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   
```

### **Data Mutation Chain**
```
User Action (Save/Update/Delete)
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Component       â”‚ â”€â”€â”€â”€ Validation â”€â”€â–º Form Validation
â”‚ Event Handler   â”‚                     
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”€â”€â”€â”€ API Call â”€â”€â”€â”€â–º Database Update
        â”‚                               
        â”‚           â”€â”€â”€â”€ Success â”€â”€â”€â”€â”€â–º Cache Invalidation
        â–¼                               
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     
â”‚ React Query     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Background Refetch
â”‚ Cache Managementâ”‚                     
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     
        â”‚                               
        â–¼                               
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     
â”‚ UI Re-render    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Visual Update
â”‚ & State Sync    â”‚                     
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     
```

---

## ğŸ¨ **UI STATE SYNCHRONIZATION**

### **Modal Orchestration**
```
TacticalMapPage (Modal Controller)
        â”‚
        â”œâ”€â”€ showPlayerModal â”€â”€â”€â”€â”€â”€â”€â”€â–º PlayerModal
        â”‚   â”‚                        â”‚
        â”‚   â””â”€â”€ closeModal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ (onClose callback)
        â”‚
        â”œâ”€â”€ showBaseReportModal â”€â”€â”€â–º ActionReportModal
        â”‚   â”‚                        â”‚
        â”‚   â””â”€â”€ reportData â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ (baseId, coords)
        â”‚
        â”œâ”€â”€ newBaseModal.visible â”€â”€â–º BaseModal
        â”‚   â”‚                        â”‚
        â”‚   â”œâ”€â”€ modalType â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ (friendly/enemy)
        â”‚   â””â”€â”€ editingLocation â”€â”€â”€â”€â”˜ (update mode)
        â”‚
        â””â”€â”€ showProgressionModal â”€â”€â–º ProgressionModal
            â”‚                        â”‚
            â””â”€â”€ progressionDisplay â”€â”˜ (gene data sync)
```

This interaction map shows the complex web of dependencies, data flows, and communication patterns that make your tactical map application a cohesive, powerful tool for Rust strategic planning. Each component is interconnected through multiple channels, creating a robust and responsive user experience.